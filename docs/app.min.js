(()=>{var e={570:(e,t,s)=>{"use strict";var n=s(379),i=s.n(n),a=s(686),r=s.n(a);i()(r(),{insert:"head",singleton:!1}),r().locals;const o=36e5,c=(e,t,s)=>e>1?s:t,l=(e,t,s)=>e?e+" "+c(e,t,s):"",h=(e,t)=>e.toString().padStart(t,"0");class u{static getFullWords(e){const t=" and ",s=new Date(e),n=s.getUTCHours(),i=s.getUTCMinutes(),a=s.getUTCSeconds();let r="",o="";switch((n?8:0)+(i?4:0)+(a?2:0)){case 0:case 2:case 4:case 8:break;case 6:case 10:o=t;break;case 12:r=t;break;case 14:r=", ",o=t}return l(n,"hour","hours")+r+l(i,"minute","minutes")+o+l(a,"second","seconds")}static getDigits(e){const t=e%o/6e4|0,s=e%6e4/1e3|0;return`${h(e%864e5/o|0,2)}:${h(t,2)}:${h(s,2)}`}static getHours(e){const t=Math.round(e/1e3/60/60);return`${t} ${c(t,"hour","hours")}`}static getMinutes(e){const t=Math.round(e/1e3/60);return`${t} ${c(t,"minute","minutes")}`}}const m=((...e)=>{const t=new Map;return e.forEach((([e,s])=>{t.set(e,s)})),t})(["before","success"],["running","primary"],["hanging","warning"],["after","success"],["rest","unknown"]),d=Object.freeze(["before","running","hanging","after","rest"]);class _{constructor(e,t,s,n){this.title=e,this.start=t,this.end=s,this.duration=this.end-this.start,this.type=d.includes(n)?n:void 0}static getBeltItemType(e){var t;return null!==(t=m.get(e))&&void 0!==t?t:"unknown"}includes(e){return this.start<=e&&e<=this.end}}var p,g,v;p=_,g="rest",v=Object.freeze(new _("Rest",void 0,void 0,"rest")),g in p?Object.defineProperty(p,g,{value:v,enumerable:!0,configurable:!0,writable:!0}):p.rest=v;class f{constructor(e,t){!function(e,t,s){t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s}(this,"_date",new Date),this._date.setHours(e),this._date.setMinutes(t),this._date.setSeconds(0)}valueOf(){return this._date.valueOf()}}function I(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const b=Object.freeze(["timechange","remindspanchange","spanchange"]);class E{constructor(e,t,s,n,i,a){this.scheduleDuration=e,this.scheduleCurrent=t,this.scheduleLeft=s,this.spanIndex=n,this.spanLeft=i,this.span=a}}var y=s(800),x=s.n(y);i()(x(),{insert:"head",singleton:!1}),x().locals;const w=(e,t)=>{if(e>t)throw new Error(`incorrect: part === ${e} > total === ${t}!`);return 100*e/t};Object.freeze(["primary","success","warning","failure","comment","unknown"]);class O{constructor(e,t,s){const n=document.createElement("div");n.className=`belt-item belt-item--${s}`;const i=document.createElement("div");i.className="belt-item__value",n.appendChild(i),this.itemElement=n,this.valueElement=i,this.value=e,this.max=t,this.type=s}}class ${static init(e,t){const s=new $;return s.init(e,t),s}init(e,t){this._element=e,this._max=t.max,this._beltItems=[],[...this._element.childNodes].forEach((e=>e.remove())),t.items.forEach(((e,t)=>{const s=new O(e.value,e.max,e.type);this._beltItems.push(s),this._element.appendChild(s.itemElement),this.setItemMax(t,e.max),this.setItemValue(t,e.value)}))}getItemByIndex(e){return this._beltItems[e]}setItemMax(e,t){const s=this.getItemByIndex(e);s.max=t,s.itemElement.style.width=`${w(t,this._max)}%`}setItemValue(e,t){const s=this.getItemByIndex(e);s.value=t,s.valueElement.style.width=`${w(t,s.max)}%`}setItemType(e,t){const s=this.getItemByIndex(e);s.type=t,s.itemElement.className=`belt-item belt-item--${t}`}setValue(e){this._beltItems.forEach(((t,s)=>{e-=t.max,this.setItemValue(s,e>0?t.max:t.max+e)}))}setType(e){this._beltItems.forEach(((t,s)=>{this.setItemType(s,e)}))}selectItem(e){const t=this.getItemByIndex(e);t.itemElement.className=`belt-item belt-item--${t.type} belt-item--selected`}resetSelection(){this._beltItems.forEach((e=>{e.itemElement.className=`belt-item belt-item--${e.type}`}))}}var L;const S=new class{constructor(){I(this,"_events",{}),I(this,"_spans",[]),I(this,"_remindBefore",0),I(this,"_intervalId",0),I(this,"_start",0),I(this,"_end",0)}_emit(e,...t){this._events[e].forEach((e=>e(...t)))}_getSpanByTime(e){var t;return null!==(t=this._spans.find((t=>t.includes(e))))&&void 0!==t?t:_.rest}_getState(){const e=Date.now(),t=this._getSpanByTime(e),s=this._spans.indexOf(t);if("rest"===t.type)return new E(0,0,0,-1,0,t);{const n=this._duration,i=this._end-e,a=n-i,r=t.end-e;return new E(n,a,i,s,r,t)}}init(e){this._spans=[],e.spans.forEach((e=>{const[t,s]=e.start.split(":"),[n,i]=e.end.split(":");this._spans.push(new _(e.title,new f(t,s),new f(n,i),e.type))})),this._remindBefore=60*e.remindBefore*1e3,this._start=this._spans[0].start,this._end=this._spans[this._spans.length-1].end,this._duration=this._end-this._start}addEventListener(e,t){b.includes(e)&&(this._events[e]=this._events[e]||[],this._events[e].push(t))}run(){let e,t=this._getState();this._emit("spanchange",t),this._emit("timechange",t),this._intervalId=setInterval((()=>{e=t,t=this._getState(),"rest"!==t.span.type&&this._emit("timechange",t),Math.abs(t.spanLeft-this._remindBefore)<500&&this._emit("remindspanchange",t),e.spanIndex!==t.spanIndex&&this._emit("spanchange",t)}),1e3)}stop(){clearInterval(this._intervalId)}getBeltOptions(){let e=[],t=this._duration;return e=this._spans.map((e=>({value:0,max:e.duration,type:_.getBeltItemType(e.type)}))),{items:e,max:t}}},B=new class{constructor(e="APP_NAME"){this._LOCAL_STORAGE_ITEM_KEY=e,this._load(),this._save()}_save(){localStorage.setItem(this._LOCAL_STORAGE_ITEM_KEY,JSON.stringify(this._cache))}_load(){var e;this._cache=null!==(e=JSON.parse(localStorage.getItem(this._LOCAL_STORAGE_ITEM_KEY)))&&void 0!==e?e:Object.create(null)}getItem(e){var t;return null!==(t=this._cache[e])&&void 0!==t?t:null}setItem(e,t){this._cache[e]=t,this._save()}removeItem(e){this._cache[e]=void 0,this._save()}clear(){localStorage.removeItem(this._LOCAL_STORAGE_ITEM_KEY)}}("utio"),T=new $,M=document.getElementById("utio-header"),C=document.getElementById("utio-output"),j=document.getElementById("utio-select"),N=e=>{fetch(`app/config/${e}`).then((e=>e.json())).then((e=>{S.stop(),S.init(e),T.init(document.getElementById("utio-belt"),S.getBeltOptions()),S.run()}))};S.addEventListener("timechange",(e=>{document.title=`${u.getDigits(e.scheduleLeft)} - utio`,C.value=`${u.getDigits(e.spanLeft)} before next, ~${u.getHours(e.scheduleLeft)} until end.`,T.setValue(e.scheduleCurrent)})),S.addEventListener("remindspanchange",(e=>{(class{static get _granted(){return"granted"===Notification.permission}static _create(e,t){return new Notification(e,t)}static _request(){return Notification.requestPermission()}static show(e,t){this._granted?this._create(e,t):this._request().then((s=>{"granted"===s&&this._create(e,t)}))}}).show(`${e.span.title} will end soon!`,{body:`It's ${u.getMinutes(e.spanLeft)} before it ends.`})})),S.addEventListener("spanchange",(e=>{M.textContent=`${e.span.title}`,T.resetSelection(),e.spanIndex>-1&&T.selectItem(e.spanIndex)}));const k=null!==(L=B.getItem("config"))&&void 0!==L?L:"work-local.json";j.value=k,N(k),j.addEventListener("change",(()=>{B.setItem("config",j.value),N(j.value)}))},686:()=>{},800:()=>{}},t={};function s(n){if(t[n])return t[n].exports;var i=t[n]={exports:{}};return e[n](i,i.exports,s),i.exports}s.m=e,s.x=e=>{},s.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return s.d(t,{a:t}),t},s.d=(e,t)=>{for(var n in t)s.o(t,n)&&!s.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={143:0},t=[[570,216]],n=e=>{},i=(i,a)=>{for(var r,o,[c,l,h,u]=a,m=0,d=[];m<c.length;m++)o=c[m],s.o(e,o)&&e[o]&&d.push(e[o][0]),e[o]=0;for(r in l)s.o(l,r)&&(s.m[r]=l[r]);for(h&&h(s),i&&i(a);d.length;)d.shift()();return u&&t.push.apply(t,u),n()},a=self.webpackChunkutio=self.webpackChunkutio||[];function r(){for(var n,i=0;i<t.length;i++){for(var a=t[i],r=!0,o=1;o<a.length;o++){var c=a[o];0!==e[c]&&(r=!1)}r&&(t.splice(i--,1),n=s(s.s=a[0]))}return 0===t.length&&(s.x(),s.x=e=>{}),n}a.forEach(i.bind(null,0)),a.push=i.bind(null,a.push.bind(a));var o=s.x;s.x=()=>(s.x=o||(e=>{}),(n=r)())})(),s.x()})();